{
  "name": "Nfebrasil",
  "tagline": "API de Nota Fiscal",
  "body": "NFeBrasil API\r\n---\r\n\r\nA princípio, essa API tem um único objetivo que é recuperar dados de uma nota fiscal referente a chave de acesso desejada.\r\n\r\nAs informações são parseadas do site da [Fazenda](http://www.nfe.fazenda.gov.br/portal/consulta.aspx?tipoConsulta=completa).\r\n\r\n## Resposta\r\n```json\r\n{\r\n\t\"nfe\": {\r\n\t    \"dados\": {\r\n\t        \"serie\": number,\r\n\t        \"numero\": string,\r\n\t        \"total\": number\r\n\t    },\r\n\t    \"emitente\": {\r\n\t        \"cnpj\": string,\r\n\t        \"razao_social\": string,\r\n\t        \"nome_fantasia\": string,\r\n\t        \"endereco\": string,\r\n\t        \"uf\": string,\r\n\t        \"cidade\": string,\r\n\t    },\r\n\t    \"items\": [{\r\n\t    \t\"indice\": number,\r\n            \"descricao\": string,\r\n            \"quantidade\": number,\r\n            \"unidade\": string,\r\n            \"valor\": number\r\n\t    }]\r\n\t}\r\n}\r\n```\r\n\r\n# Consumindo a API\r\n\r\n## 1. Credenciais\r\nFaço o cadastro da aplicação que irá consumir a API em (https://nfebrasil.herokuapp.com/o/applications).\r\n\r\nEx:\r\nClient type: `Confidential`  \r\nGrant type: `Client credentials`\r\n\r\n**Importante:** É recomendado o uso de fluxos OAuth não baseados em redirecionamento. Por isso não é necessário se preocupar com o campo `redirect uris`.\r\n\r\n## 2. Access Token\r\n\r\nClient credential:\r\n```\r\ncurl --user <client_id>:<client_secret> --data \"grant_type=client_credentials\" https://nfebrasil.herokuapp.com/o/token/\r\n```\r\n\r\n```json\r\n{\r\n\t\"access_token\": \"nuT0noX8eJgQQXc0o0mWL6uMoCFk88\", \r\n\t\"scope\": \"read\", \r\n\t\"expires_in\": 36000, \r\n\t\"token_type\": \"Bearer\"\r\n}\r\n```\r\n\r\n## 3. Captcha\r\nO site da fazenda solicita um captcha. Atualmente a forma que a API lida com isso é repassando o captcha para ser resolvido no lado do usuário:\r\n\r\nFaça a primeira requisição para (https://nfebrasil.herokuapp.com/api/) com o Access Token da requisição anterior.\r\n\r\n```\r\ncurl -H \"Authorization: Bearer <access_token>\" https://nfebrasil.herokuapp.com/api/\r\n```\r\n\r\nReceberá a seguinte resposta:\r\n\r\n```json\r\n{\r\n\t\"captcha_src\": \"data:image/png;base64,iVBORw0K...\"\r\n}\r\n```\r\nO valor de `captcha_src` deve ser entrada para a formação de uma imagem, por exemplo:\r\n\r\n```html\r\n<img src=\"<captcha_src>\" />\r\n```\r\n\r\n## 4. Informações da NFe\r\n\r\nCom o mesmo access_token usado para fazer a requisição do captcha, faça um nova requisição passando o captcha decifrado e a chave de acesso:\r\n\r\n```\r\ncurl -H \"Authorization: Bearer nuT0noX8eJgQQXc0o0mWL6uMoCFk88\" --data \"nfeAccessKey=<chave_de_acesso>&nfeCaptcha=<captcha_lowercase>\" https://nfebrasil.herokuapp.com/api/\r\n```\r\n\r\n# Considerações\r\n\r\n- A versão está em desenvolvimento. Sugira o que quiser.\r\n- O slash `/` no final das URLs são importantes.\r\n- A API não é e provavelmente não será estável. O parseamento usa XPath e por isso qualquer alteração na página de exibição da NF no site da Fazenda irá quebrar a resposta.\r\n- O código estará no GitHub em breve.\r\n- Por pelo menos 30 minutos diário o serviço ficará offline pois está hospedado na conta free do Heroku.\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}